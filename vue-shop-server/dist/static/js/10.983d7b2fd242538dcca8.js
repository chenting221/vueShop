webpackJsonp([10],{"QNL/":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("mvHQ"),a=i.n(n),o=i("Dd8w"),s=i.n(o),l=i("NYxO"),r={name:"Roles",data:function(){return{tableData:[],loading:!1,pageInfos:{pagesizes:[10,25,50,100],pagesize:10,pageindex:1,total:0},dialogFormVisible:!1,dialogFormVisible2:!1,dialogFormVisible3:!1,editInfos:{}}},components:{"add-roles":function(){return i.e(20).then(i.bind(null,"IgJC"))},"edit-roles":function(){return i.e(22).then(i.bind(null,"bpVN"))},allocation:function(){return i.e(14).then(i.bind(null,"gvex"))}},computed:s()({tableHeight:function(){return window.innerHeight-302}},Object(l.b)({stateApi:function(e){return e.api}})),methods:{init:function(){var e=this;e.loading=!0,e.$axios({method:"get",url:e.stateApi.sys.power.roles}).then(function(t){var i=t.data;e.loading=!1,200===i.meta.status?e.tableData=i.data:e.$message.error(i.meta.msg)}).catch(function(){e.loading=!1})},removeRightById:function(e,t){var i=this;i.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.$axios({method:"delete",url:"https://www.liulongbin.top:8888/api/private/v1/roles/"+e.id+"/rights/"+t}).then(function(t){i.loading=!1;var n=t.data;200===n.meta.status?(i.$message.success(n.meta.msg),e.children=n.data):i.$message.error(n.meta.msg)}).catch(function(){i.loading=!1})}).catch(function(){})},handleCurrentChange:function(e){this.pageInfos.pageindex=e,this.init()},handleSizeChange:function(e){this.pageInfos.pageindex=1,this.pageInfos.pagesize=e,this.init()},changeStatus:function(e){var t=this;t.$axios({method:"put",url:"https://www.liulongbin.top:8888/api/private/v1/users/"+e.id+"/state/"+e.mg_state}).then(function(i){t.loading=!1;var n=i.data;200===n.meta.status?t.$message.success(n.meta.msg):(e.mg_state=!e.mg_state,t.$message.error(n.meta.msg))}).catch(function(){t.loading=!1})},addRoles:function(){this.dialogFormVisible=!0},handleCommand:function(e,t){var i=this;"edit"===t&&(i.dialogFormVisible2=!0,i.editInfos=JSON.parse(a()(e))),"del"===t&&i.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.$axios({method:"delete",url:"https://www.liulongbin.top:8888/api/private/v1/roles/"+e.id}).then(function(e){i.loading=!1;var t=e.data;200===t.meta.status?(i.$message.success(t.meta.msg),i.init()):i.$message.error(t.meta.msg)}).catch(function(){i.loading=!1})}).catch(function(){}),"allocation"===t&&(i.dialogFormVisible3=!0,i.editInfos=JSON.parse(a()(e)))},onRefresList:function(){this.loading=!0,this.init()},handleCloseDialog:function(){this.dialogFormVisible=!1},handleCloseDialog2:function(){this.dialogFormVisible2=!1},handleCloseDialog3:function(){this.dialogFormVisible3=!1}},created:function(){this.init()},activated:function(){this.init()}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"calc(100vh - 100px)"},attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[i("div",{staticClass:"main",staticStyle:{"margin-bottom":"20px"}},[i("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary"},on:{click:e.addRoles}},[e._v("添加角色")]),e._v(" "),i("el-table",{attrs:{stripe:"",border:"","max-height":e.tableHeight,data:e.tableData}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,function(n,a){return i("el-row",{key:n.id,class:["bdbottom",0===a?"bdtop":"","rowflex"]},[i("el-col",{attrs:{span:5}},[i("el-tag",{attrs:{closable:""},on:{close:function(i){return e.removeRightById(t.row,n.id)}}},[e._v(e._s(n.authName))]),e._v(" "),i("i",{staticClass:"el-icon-caret-right"})],1),e._v(" "),i("el-col",{attrs:{span:19}},e._l(n.children,function(n,a){return i("el-row",{key:n.id,class:[0===a?"":"bdtop","rowflex"]},[i("el-col",{attrs:{span:6}},[i("el-tag",{attrs:{type:"success",closable:""},on:{close:function(i){return e.removeRightById(t.row,n.id)}}},[e._v(e._s(n.authName))]),e._v(" "),i("i",{staticClass:"el-icon-caret-right"})],1),e._v(" "),i("el-col",{attrs:{span:18}},e._l(n.children,function(n){return i("el-tag",{key:n.id,attrs:{closable:"",type:"warning"},on:{close:function(i){return e.removeRightById(t.row,n.id)}}},[e._v(e._s(n.authName))])}),1)],1)}),1)],1)})}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center","header-align":"center",prop:"roleName",label:"角色名称"}}),e._v(" "),i("el-table-column",{attrs:{align:"center","header-align":"center",prop:"roleDesc",label:"角色描述"}}),e._v(" "),i("el-table-column",{attrs:{align:"center","header-align":"center",fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-dropdown",{on:{command:function(i){return e.handleCommand(t.row,i)}}},[i("el-button",{attrs:{type:"primary",plain:""}},[e._v("操作\n              "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"edit"}},[e._v("编辑")]),e._v(" "),i("el-dropdown-item",{attrs:{command:"del"}},[e._v("删除")]),e._v(" "),i("el-dropdown-item",{attrs:{command:"allocation"}},[e._v("分配权限")])],1)],1)]}}])})],1),e._v(" "),i("el-footer",[i("el-pagination",{attrs:{"current-page":e.pageInfos.pageindex,"page-sizes":e.pageInfos.pagesizes,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfos.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),e.dialogFormVisible?i("add-roles",{attrs:{visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},closeDL:e.handleCloseDialog,refreshList:e.onRefresList}}):e._e(),e._v(" "),e.dialogFormVisible2?i("edit-roles",{attrs:{visible:e.dialogFormVisible2,data:e.editInfos},on:{"update:visible":function(t){e.dialogFormVisible2=t},closeDL:e.handleCloseDialog2,refreshList:e.onRefresList}}):e._e(),e._v(" "),e.dialogFormVisible3?i("allocation",{attrs:{visible:e.dialogFormVisible3,data:e.editInfos},on:{"update:visible":function(t){e.dialogFormVisible3=t},closeDL:e.handleCloseDialog3,refreshList:e.onRefresList}}):e._e()],1)])},staticRenderFns:[]};var c=i("VU/8")(r,d,!1,function(e){i("i9SS")},"data-v-08e73002",null);t.default=c.exports},i9SS:function(e,t){}});
//# sourceMappingURL=10.983d7b2fd242538dcca8.js.map