{"version":3,"sources":["webpack:///src/components/goods/list/GoodsAddPage.vue","webpack:///./src/components/goods/list/GoodsAddPage.vue?e2c4","webpack:///./src/components/goods/list/GoodsAddPage.vue"],"names":["GoodsAddPage","name","data","loading","activeIndex","addForm","goods_name","goods_cat","goods_price","goods_number","goods_weight","goods_introduce","pics","attrs","parentCateList","manyTableData","onlyTableData","cascaderProps","value","label","children","headerObj","Authorization","this","$tool","session","get","previewPath","dialogVisible","rules","required","message","trigger","computed","extends_default","Object","vuex_esm","stateApi","state","api","created","init","activated","methods","_self","$axios","method","url","sys","goods","cate","list","then","response","meta","status","$message","error","msg","catch","handleChange","length","beforeLeave","activeName","oldActiveName","warning","tabClick","params","sel","forEach","item","attr_vals","split","handleUploadSuccess","file","fileList","picInfo","pic","tmp_path","push","handlePreview","handleRemove","filePath","i","findIndex","x","splice","addGoods","$refs","addFormRef","validate","valid","copyData","deepCopy","join","newInfo","attr_id","attr_value","success","$router","list_GoodsAddPage","render","_vm","_h","$createElement","_c","directives","rawName","expression","staticStyle","min-height","element-loading-background","staticClass","margin-bottom","title","type","center","show-icon","closable","_v","space","active","finish-status","align-center","ref","model","label-width","label-position","tab-position","before-leave","on","tab-click","callback","$$v","prop","$set","width","options","expand-trigger","props","clearable","change","_l","key","attr_name","cb","border","action","upload","on-preview","on-remove","headers","on-success","list-type","size","margin-top","click","visible","update:visible","$event","src","alt","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/5.179e759ce447b208c6bc.js","sourcesContent":["<template>\n  <div\n    style=\"min-height: calc(100vh - 100px)\"\n    v-loading=\"loading\"\n    element-loading-background=\"rgba(0, 0, 0, 0)\"\n  >\n    <div\n      class=\"main\"\n      style=\"margin-bottom: 20px;\"\n    >\n      <el-alert\n        title=\"添加商品信息\"\n        type=\"info\"\n        center\n        show-icon\n        :closable=\"false\"\n      >\n      </el-alert>\n      <el-steps\n        :space=\"200\"\n        :active=\"activeIndex - 0\"\n        finish-status=\"success\"\n        align-center\n      >\n        <el-step title=\"基本信息\"></el-step>\n        <el-step title=\"商品参数\"></el-step>\n        <el-step title=\"商品属性\"></el-step>\n        <el-step title=\"商品图片\"></el-step>\n        <el-step title=\"商品内容\"></el-step>\n        <el-step title=\"完成\"></el-step>\n      </el-steps>\n      <el-form :model=\"addForm\" :rules=\"rules\" ref=\"addFormRef\" label-width=\"100px\" label-position=\"top\">\n        <el-tabs :tab-position=\"'left'\" v-model=\"activeIndex\" :before-leave=\"beforeLeave\" @tab-click=\"tabClick\">\n          <el-tab-pane label=\"基本信息\" name=\"0\">\n            <el-form-item label=\"商品名称\" prop=\"goods_name\">\n              <el-input v-model=\"addForm.goods_name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品价格\" prop=\"goods_price\">\n              <el-input type=\"number\" v-model=\"addForm.goods_price\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品重量\" prop=\"goods_weight\">\n              <el-input type=\"number\" v-model=\"addForm.goods_weight\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品数量\" prop=\"goods_number\">\n              <el-input type=\"number\" v-model=\"addForm.goods_number\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品分类\" prop=\"goods_cat\">\n              <el-cascader\n                style=\"width: 40%;\"\n                :options=\"parentCateList\"\n                v-model=\"addForm.goods_cat\"\n                expand-trigger=\"hover\"\n                :props=\"cascaderProps\"\n                @change=\"handleChange\"\n                clearable\n              ></el-cascader>\n            </el-form-item>\n          </el-tab-pane>\n          <el-tab-pane label=\"商品参数\" name=\"1\">\n            <el-form-item :label=\"item.attr_name\" v-for=\"item in manyTableData\" :key=\"item.attr_id\">\n              <el-checkbox-group v-model=\"item.attr_vals\">\n                <el-checkbox v-for=\"(cb, i) in item.attr_vals\" :key=\"i\" :label=\"cb\" border></el-checkbox>\n              </el-checkbox-group>\n            </el-form-item>\n          </el-tab-pane>\n          <el-tab-pane label=\"商品属性\" name=\"2\">\n            <el-form-item :label=\"item.attr_name\" v-for=\"item in onlyTableData\" :key=\"item.attr_id\">\n              <el-input v-model=\"item.attr_vals\"></el-input>\n            </el-form-item>\n          </el-tab-pane>\n          <el-tab-pane label=\"商品图片\" name=\"3\">\n            <el-upload\n              :action=\"this.stateApi.sys.goods.upload.upload\"\n              :on-preview=\"handlePreview\"\n              :on-remove=\"handleRemove\"\n              :headers=\"headerObj\"\n              :on-success=\"handleUploadSuccess\"\n              list-type=\"picture\">\n                <el-button size=\"small\" type=\"primary\">点击上传</el-button>\n            </el-upload>\n          </el-tab-pane>\n          <el-tab-pane label=\"商品内容\" name=\"4\">\n            <quill-editor v-model=\"addForm.goods_introduce\"></quill-editor>\n            <el-button type=\"primary\" style=\"margin-top: 15px;\" @click=\"addGoods\">添加商品</el-button>\n          </el-tab-pane>\n        </el-tabs>\n      </el-form>\n      <!-- 图片预览 -->\n      <el-dialog title=\"提示\" :visible.sync=\"dialogVisible\" width=\"50%\">\n        <img :src=\"previewPath\" alt=\"\" class=\"previewImg\"/>\n      </el-dialog>\n    </div>\n  </div>\n\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nexport default {\n  name: 'GoodsAddPage',\n  data () {\n    const _self = this\n    return {\n      loading: false,\n      activeIndex: '0',\n      addForm: {\n        goods_name: '',\n        goods_cat: [],\n        goods_price: '',\n        goods_number: '',\n        goods_weight: '',\n        goods_introduce: '',\n        pics: [],\n        attrs: []\n      },\n      parentCateList: [],\n      manyTableData: [],\n      onlyTableData: [],\n      cascaderProps: {\n        value: 'cat_id',\n        label: 'cat_name',\n        children: 'children'\n      },\n      headerObj: {\n        Authorization: _self.$tool.session.get('token')\n      },\n      previewPath: '',\n      dialogVisible: false,\n      rules: {\n        goods_name: [{ required: true, message: '请输入商品名称', trigger: 'blur' }],\n        goods_price: [{ required: true, message: '请输入商品价格', trigger: 'blur' }],\n        goods_weight: [{ required: true, message: '请输入商品重量', trigger: 'blur' }],\n        goods_number: [{ required: true, message: '请输入商品数量', trigger: 'blur' }],\n        goods_cat: [{ required: true, message: '请选择商品分类', trigger: 'change' }]\n      }\n    }\n  },\n  computed: {\n    ...mapState({\n      stateApi: state => state.api\n    })\n  },\n  created () {\n    const _self = this\n    _self.init()\n  },\n  activated () {\n    const _self = this\n    _self.init()\n  },\n  methods: {\n    /**\n     * 页面初始化调用\n     * @returns void\n     */\n    init () {\n      const _self = this\n      _self.loading = true\n      _self\n        .$axios({\n          method: 'get',\n          url: _self.stateApi.sys.goods.cate.list\n        })\n        .then(response => {\n          const { data } = response\n          _self.loading = false\n          if (data.meta.status === 200) {\n            _self.parentCateList = data.data\n          } else {\n            _self.$message.error(data.meta.msg)\n          }\n        })\n        .catch(() => {\n          _self.loading = false\n        })\n    },\n    handleChange (value) {\n      const _self = this\n      if (!value.length === 3) {\n        _self.addForm.goods_cat = []\n      }\n    },\n    beforeLeave (activeName, oldActiveName) {\n      const _self = this\n      if (oldActiveName === '0' && _self.addForm.goods_cat.length !== 3) {\n        _self.$message.warning('请先选择商品分类')\n        return false\n      }\n    },\n    tabClick () {\n      const _self = this\n      // 访问的动态参数面板\n      if (_self.activeIndex === '1') {\n        _self\n          .$axios({\n            method: 'get',\n            url: _self.stateApi.sys.goods.cate.list + '/' + _self.addForm.goods_cat[2] + '/attributes',\n            params: {\n              sel: 'many'\n            }\n          })\n          .then(response => {\n            const { data } = response\n            _self.loading = false\n            if (data.meta.status === 200) {\n              data.data.forEach(item => {\n                item.attr_vals = item.attr_vals ? item.attr_vals.split(' ') : []\n              })\n              _self.manyTableData = data.data\n            } else {\n              _self.$message.error(data.meta.msg)\n            }\n          })\n          .catch(() => {\n            _self.loading = false\n          })\n      }\n      if (_self.activeIndex === '2') {\n        _self\n          .$axios({\n            method: 'get',\n            url: _self.stateApi.sys.goods.cate.list + '/' + _self.addForm.goods_cat[2] + '/attributes',\n            params: {\n              sel: 'only'\n            }\n          })\n          .then(response => {\n            const { data } = response\n            _self.loading = false\n            if (data.meta.status === 200) {\n              _self.onlyTableData = data.data\n            } else {\n              _self.$message.error(data.meta.msg)\n            }\n          })\n          .catch(() => {\n            _self.loading = false\n          })\n      }\n    },\n    handleUploadSuccess (response, file, fileList) {\n      const _self = this\n      const picInfo = {\n        pic: response.data.tmp_path\n      }\n      _self.addForm.pics.push(picInfo)\n    },\n    handlePreview (file) {\n      const _self = this\n      _self.previewPath = file.response.data.url\n      _self.dialogVisible = true\n    },\n    handleRemove (file) {\n      const _self = this\n      const filePath = file.response.data.tmp_path\n      const i = _self.addForm.pics.findIndex(x => x.pic === filePath)\n      _self.addForm.pics.splice(i, 1)\n    },\n    addGoods () {\n      const _self = this\n      _self.$refs.addFormRef.validate((valid) => {\n        if (valid) {\n          const copyData = _self.$tool.deepCopy(_self.addForm)\n          copyData.goods_cat = copyData.goods_cat.join(',')\n          // 处理动态参数\n          _self.manyTableData.forEach(item => {\n            const newInfo = {\n              attr_id: item.attr_id,\n              attr_value: item.attr_vals.join(' ')\n            }\n            _self.addForm.attrs.push(newInfo)\n          })\n          // 处理静态属性\n          _self.onlyTableData.forEach(item => {\n            const newInfo = {\n              attr_id: item.attr_id,\n              attr_value: item.attr_vals\n            }\n            _self.addForm.attrs.push(newInfo)\n          })\n          copyData.attrs = _self.addForm.attrs\n          // 发起请求\n          _self\n            .$axios({\n              method: 'post',\n              url: _self.stateApi.sys.goods.goods.list,\n              data: copyData\n            })\n            .then(response => {\n              const { data } = response\n              _self.loading = false\n              if (data.meta.status === 201) {\n                _self.$message.success(data.meta.msg)\n                _self.$router.push('/goods')\n              } else {\n                _self.$message.error(data.meta.msg)\n              }\n            })\n            .catch(() => {\n              _self.loading = false\n            })\n        } else {\n          _self.$message.warning('请填写必要的表单项')\n          return false\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.main {\n  padding: 20px;\n  background: #ffffff;\n}\n.el-form {\n  display: flex;\n}\n.el-form-item {\n  margin-bottom: 0px;\n}\n.el-form-item.flex1 {\n  flex: 1;\n}\n.el-form-item:last-child {\n  margin-right: 0px;\n}\n.el-footer {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n}\n.el-tabs {\n  width: 100%;\n}\n.el-steps {\n  margin: 20px;\n}\n.previewImg {\n  width: 100%;\n}\n/deep/.el-step__title {\n  font-size: 13px;\n}\n/deep/.el-checkbox {\n  margin: 0 5px 0 0;\n}\n/deep/.ql-editor {\n  min-height: 300px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/goods/list/GoodsAddPage.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticStyle:{\"min-height\":\"calc(100vh - 100px)\"},attrs:{\"element-loading-background\":\"rgba(0, 0, 0, 0)\"}},[_c('div',{staticClass:\"main\",staticStyle:{\"margin-bottom\":\"20px\"}},[_c('el-alert',{attrs:{\"title\":\"添加商品信息\",\"type\":\"info\",\"center\":\"\",\"show-icon\":\"\",\"closable\":false}}),_vm._v(\" \"),_c('el-steps',{attrs:{\"space\":200,\"active\":_vm.activeIndex - 0,\"finish-status\":\"success\",\"align-center\":\"\"}},[_c('el-step',{attrs:{\"title\":\"基本信息\"}}),_vm._v(\" \"),_c('el-step',{attrs:{\"title\":\"商品参数\"}}),_vm._v(\" \"),_c('el-step',{attrs:{\"title\":\"商品属性\"}}),_vm._v(\" \"),_c('el-step',{attrs:{\"title\":\"商品图片\"}}),_vm._v(\" \"),_c('el-step',{attrs:{\"title\":\"商品内容\"}}),_vm._v(\" \"),_c('el-step',{attrs:{\"title\":\"完成\"}})],1),_vm._v(\" \"),_c('el-form',{ref:\"addFormRef\",attrs:{\"model\":_vm.addForm,\"rules\":_vm.rules,\"label-width\":\"100px\",\"label-position\":\"top\"}},[_c('el-tabs',{attrs:{\"tab-position\":'left',\"before-leave\":_vm.beforeLeave},on:{\"tab-click\":_vm.tabClick},model:{value:(_vm.activeIndex),callback:function ($$v) {_vm.activeIndex=$$v},expression:\"activeIndex\"}},[_c('el-tab-pane',{attrs:{\"label\":\"基本信息\",\"name\":\"0\"}},[_c('el-form-item',{attrs:{\"label\":\"商品名称\",\"prop\":\"goods_name\"}},[_c('el-input',{model:{value:(_vm.addForm.goods_name),callback:function ($$v) {_vm.$set(_vm.addForm, \"goods_name\", $$v)},expression:\"addForm.goods_name\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"商品价格\",\"prop\":\"goods_price\"}},[_c('el-input',{attrs:{\"type\":\"number\"},model:{value:(_vm.addForm.goods_price),callback:function ($$v) {_vm.$set(_vm.addForm, \"goods_price\", $$v)},expression:\"addForm.goods_price\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"商品重量\",\"prop\":\"goods_weight\"}},[_c('el-input',{attrs:{\"type\":\"number\"},model:{value:(_vm.addForm.goods_weight),callback:function ($$v) {_vm.$set(_vm.addForm, \"goods_weight\", $$v)},expression:\"addForm.goods_weight\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"商品数量\",\"prop\":\"goods_number\"}},[_c('el-input',{attrs:{\"type\":\"number\"},model:{value:(_vm.addForm.goods_number),callback:function ($$v) {_vm.$set(_vm.addForm, \"goods_number\", $$v)},expression:\"addForm.goods_number\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"商品分类\",\"prop\":\"goods_cat\"}},[_c('el-cascader',{staticStyle:{\"width\":\"40%\"},attrs:{\"options\":_vm.parentCateList,\"expand-trigger\":\"hover\",\"props\":_vm.cascaderProps,\"clearable\":\"\"},on:{\"change\":_vm.handleChange},model:{value:(_vm.addForm.goods_cat),callback:function ($$v) {_vm.$set(_vm.addForm, \"goods_cat\", $$v)},expression:\"addForm.goods_cat\"}})],1)],1),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"商品参数\",\"name\":\"1\"}},_vm._l((_vm.manyTableData),function(item){return _c('el-form-item',{key:item.attr_id,attrs:{\"label\":item.attr_name}},[_c('el-checkbox-group',{model:{value:(item.attr_vals),callback:function ($$v) {_vm.$set(item, \"attr_vals\", $$v)},expression:\"item.attr_vals\"}},_vm._l((item.attr_vals),function(cb,i){return _c('el-checkbox',{key:i,attrs:{\"label\":cb,\"border\":\"\"}})}),1)],1)}),1),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"商品属性\",\"name\":\"2\"}},_vm._l((_vm.onlyTableData),function(item){return _c('el-form-item',{key:item.attr_id,attrs:{\"label\":item.attr_name}},[_c('el-input',{model:{value:(item.attr_vals),callback:function ($$v) {_vm.$set(item, \"attr_vals\", $$v)},expression:\"item.attr_vals\"}})],1)}),1),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"商品图片\",\"name\":\"3\"}},[_c('el-upload',{attrs:{\"action\":this.stateApi.sys.goods.upload.upload,\"on-preview\":_vm.handlePreview,\"on-remove\":_vm.handleRemove,\"headers\":_vm.headerObj,\"on-success\":_vm.handleUploadSuccess,\"list-type\":\"picture\"}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传\")])],1)],1),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"商品内容\",\"name\":\"4\"}},[_c('quill-editor',{model:{value:(_vm.addForm.goods_introduce),callback:function ($$v) {_vm.$set(_vm.addForm, \"goods_introduce\", $$v)},expression:\"addForm.goods_introduce\"}}),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin-top\":\"15px\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addGoods}},[_vm._v(\"添加商品\")])],1)],1)],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":\"提示\",\"visible\":_vm.dialogVisible,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('img',{staticClass:\"previewImg\",attrs:{\"src\":_vm.previewPath,\"alt\":\"\"}})])],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-59437bdd\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/goods/list/GoodsAddPage.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-59437bdd\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./GoodsAddPage.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./GoodsAddPage.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./GoodsAddPage.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-59437bdd\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./GoodsAddPage.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-59437bdd\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/goods/list/GoodsAddPage.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}